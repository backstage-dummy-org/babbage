@startuml

!include defONSQueryBuilders.def

!definelong buildSearchQuery(caller)
caller-> SearchUtils : buildSearchQuery
    activate SearchUtils
    func(SearchUtils,SearchUtils, isAdvancedSearch)
    func(SearchUtils, SearchUtils, extractSortBy)

       alt isAdvancedSearch?
            advancedSearchQuery(SearchUtils)
       else
            contentQuery(SearchUtils)
       end
    SearchUtils -> SearchUtils : buildONSQuery
        activate SearchUtils
        create ONSQuery

        SearchUtils -> ONSQuery : //new(QueryBuilder)//
        SearchUtils <-- SearchUtils : ONSQuery
        deactivate SearchUtils

    alt isAdvancedSearchQuery
        SearchUtils -> SearchUtils : phraseSuggestion
        SearchUtils -> ONSQuery : suggest
    end
    caller <-- SearchUtils: ONSQuery
    deactivate SearchUtils
!enddefinelong
@enduml